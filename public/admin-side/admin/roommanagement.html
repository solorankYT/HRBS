<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H+Hotel - Room Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700;900&family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
     <link href="../css/styles.css" rel="stylesheet">
    <script>
        (function() {
            try {
                if (localStorage.getItem('sidebarCollapsed') === 'true') {
                    document.documentElement.classList.add('precollapsed');
                }
            } catch (e) {}
        })();
    </script>
    <style>
        /* Font Family Declarations */
        body {
            font-family: 'Poppins', sans-serif;
        }
        
        /* Headers and Titles */
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Playfair Display', serif;
            font-weight: 600;
        }
        
        .reservation-title {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
        }
        
        .hotel-name {
            font-family: 'Playfair Display', serif;
            font-weight: 600;
        }
        
        .admin-label {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
        }
        
        /* Navigation */
        .nav-link {
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
        }
        
        .nav-link span {
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
        }
        
        /* Profile Section */
        .profile-name {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
        }
        
        .profile-role {
            font-family: 'Poppins', sans-serif;
            font-weight: 400;
        }
        
        /* KPI Cards */
        .kpi-number {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
        }
        
        .kpi-label {
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
        }
        
        /* Room Card Headers */
        .info-card .card-header h5 {
            font-family: 'Playfair Display', serif;
            font-weight: 600;
        }
        
        /* Room Details */
        .field-label {
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
        }
        
        .detail-value {
            font-family: 'Playfair Display', serif;
            font-weight: 600;
        }
        
        .room-capacity {
            font-family: 'Poppins', sans-serif;
            font-weight: 400;
        }
        
        .amenity-item {
            font-family: 'Poppins', sans-serif;
            font-weight: 400;
        }
        
        .room-description {
            font-family: 'Poppins', sans-serif;
            font-weight: 400;
        }
        
        /* Status Badges */
        .status-badge {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
        }
        
        /* Search and Input Elements */
        .search-input {
            font-family: 'Poppins', sans-serif;
            font-weight: 400;
        }
        
        /* Buttons */
        .btn {
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
        }
        
        .new-reservation-btn {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
        }
        
        .room-edit-large {
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
        }
        
        /* Modal Elements */
        .modal-title {
            font-family: 'Playfair Display', serif;
            font-weight: 600;
        }
        
        .form-label {
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
        }
        
        .form-control, .form-select {
            font-family: 'Poppins', sans-serif;
            font-weight: 400;
        }
        
        /* Remove card hover effects and transitions on this page */
        .info-card { transition: none !important; }
        .info-card:hover { transform: none !important; box-shadow: 0 2px 10px rgba(0,0,0,0.1) !important; }
        .kpi-card { transition: none !important; }
        .kpi-card:hover { transform: none !important; box-shadow: 0 2px 10px rgba(0,0,0,0.1) !important; }
        /* Large Edit button styling */
        .room-edit-large {
            background-color: #e7f1ff;
            color: #0d6efd;
            border: 1px solid #cfe2ff;
            border-radius: 6px;
            padding: 0.45rem 1rem;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            min-width: 200px;
            justify-content: center;
        }
        .room-edit-large:hover { background-color: #d7e7ff; color: #0b5ed7; }
        .room-actions { display: flex; align-items: center; gap: 8px; }
        .room-delete { color: #6c757d; }
        .room-delete:hover { color: #dc3545; }
    </style>
    <style>
        /* Make + Add Room Type button completely static (no hover/focus/active change) */
        #addRoomTypeBtn,
        #addRoomTypeBtn:hover,
        #addRoomTypeBtn:focus,
        #addRoomTypeBtn:active,
        #addRoomTypeBtn:focus-visible {
            box-shadow: none !important;
            outline: none !important;
            text-decoration: none !important;
            transform: none !important;
            transition: none !important;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <nav class="col-md-3 col-lg-2 d-md-block sidebar">
                <div class="sidebar-header clickable" id="sidebarToggle">
                    <span class="logo-text">logo</span>
                    <h4 class="hotel-name">H+Hotel</h4>
                    <i class="fas fa-bars toggle-icon" aria-label="Collapse sidebar"></i>
                </div>
                
                <ul class="nav flex-column main-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html" data-tooltip="Dashboard">
                            <i class="fas fa-th-large"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="reservations.html" data-tooltip="Reservations">
                            <i class="fas fa-calendar"></i>
                            <span>Reservations</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="payment.html" data-tooltip="Payments">
                            <i class="fas fa-credit-card"></i>
                            <span>Payments</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="usermanagement.html" data-tooltip="User Management">
                            <i class="fas fa-users"></i>
                            <span>User Management</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="roommanagement.html" data-tooltip="Room Management">
                            <i class="fas fa-bed"></i>
                            <span>Room Management</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="reports.html" data-tooltip="Reports">
                            <i class="fas fa-chart-bar"></i>
                            <span>Reports</span>
                        </a>
                    </li>
                </ul>
                
                <ul class="nav flex-column secondary-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="settings.html" data-tooltip="Settings">
                            <i class="fas fa-cog"></i>
                            <span>Settings</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="login.html" data-tooltip="Logout">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Logout</span>
                        </a>
                    </li>
                </ul>
                
                <div class="profile-section">
                    <div class="profile-info" data-tooltip="Prince Gallardo - Admin">
                        <i class="fas fa-user-circle profile-icon"></i>
                        <div>
                            <div class="profile-name">Prince Gallardo</div>
                            <div class="profile-role">Admin</div>
                        </div>
                    </div>
                </div>
            </nav>

            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="top-bar-header d-flex justify-content-between align-items-center">
                    <div class="left-section">
                        <span class="admin-label">Admin</span>
                    </div>
                    <div class="d-flex align-items-center">
                        <div class="search-container me-4" style="margin-left: -1rem;">
                            <input type="text" class="form-control search-input" placeholder="Search reservations...">
                            <i class="fas fa-search search-icon"></i>
                        </div>
                        <div class="notification-icon me-3">
                            <i class="fas fa-bell"></i>
                        </div>
                        <div class="user-dropdown">
                            <i class="fas fa-user-circle me-2"></i>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                    </div>
                </div>

                <div class="reservation-header d-flex justify-content-between align-items-center mb-4">
                    <h1 class="reservation-title">Room Management</h1>
                    <button class="btn btn-primary new-reservation-btn" id="addRoomTypeBtn">
                        <i class="fas fa-plus me-2"></i>Add Room Type
                    </button>
                </div>

                <!-- Summary Cards -->
                <div class="row mb-4">
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="kpi-card">
                            <div class="kpi-icon light-blue">
                                <i class="fas fa-bed"></i>
                            </div>
                            <div class="kpi-content">
                                <h3 class="kpi-number">3</h3>
                                <p class="kpi-label">Total Rooms</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="kpi-card">
                            <div class="kpi-icon green">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="kpi-content">
                                <h3 class="kpi-number">1</h3>
                                <p class="kpi-label">Available</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="kpi-card">
                            <div class="kpi-icon orange">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="kpi-content">
                                <h3 class="kpi-number">2</h3>
                                <p class="kpi-label">Occupied</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-xl-3 col-md-6 mb-3">
                        <div class="kpi-card">
                            <div class="kpi-icon purple">
                                <i class="fas fa-tools"></i>
                            </div>
                            <div class="kpi-content">
                                <h3 class="kpi-number">0</h3>
                                <p class="kpi-label">Maintenance</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Room Cards -->
                <div class="row">
                    <div class="col-xl-4 col-md-6 mb-4">
                        <div class="info-card">
                            <div class="card-header d-flex justify-content-between align-items-start">
                                <div>
                                    <h5>Basic Studio Room</h5>
                                    <small class="text-muted">Room 101</small>
                                </div>
                                <span class="status-badge status-checkedout">Occupied</span>
                            </div>
                            <div class="card-body">
                                <div class="room-details">
                                    <div class="detail-row mb-2">
                                        <span class="field-label">Rate per night</span>
                                        <span class="detail-value">₱922</span>
                                    </div>
                                    <div class="detail-row mb-3">
                                        <span class="field-label">Capacity</span>
                                        <span class="detail-value"><i class="fas fa-users me-2"></i>2 guests</span>
                                    </div>
                                    <div class="field-label mb-1">Amenities</div>
                                    <div class="room-amenities mb-3">
                                        <div class="amenity-item">
                                            <i class="fas fa-wifi me-2"></i>
                                            <span>Wifi</span>
                                        </div>
                                        <div class="amenity-item">
                                            <i class="fas fa-tv me-2"></i>
                                            <span>Tv</span>
                                        </div>
                                        <div class="amenity-item">
                                            <i class="fas fa-snowflake me-2"></i>
                                            <span>Ac</span>
                                        </div>
                                    </div>
                                    <div class="room-description mb-3">
                                        <p class="text-muted">Comfortable basic studio room with modern amenities</p>
                                    </div>
                                    <div class="room-actions">
                                        <button class="room-edit-large" data-room="Basic Studio Room" data-rate="₱922" data-capacity="2" data-type="Basic Studio Room">
                                            <i class="fas fa-pen"></i> Edit
                                        </button>
                                        <button class="btn btn-link room-delete" title="Delete"><i class="fas fa-trash"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-xl-4 col-md-6 mb-4">
                        <div class="info-card">
                            <div class="card-header d-flex justify-content-between align-items-start">
                                <div>
                                    <h5>Standard Room</h5>
                                    <small class="text-muted">Room 102</small>
                                </div>
                                <span class="status-badge status-checkedout">Occupied</span>
                            </div>
                            <div class="card-body">
                                <div class="room-details">
                                    <div class="detail-row mb-2">
                                        <span class="field-label">Rate per night</span>
                                        <span class="detail-value">₱2,599</span>
                                    </div>
                                    <div class="detail-row mb-3">
                                        <span class="field-label">Capacity</span>
                                        <span class="detail-value"><i class="fas fa-users me-2"></i>2 guests</span>
                                    </div>
                                    <div class="field-label mb-1">Amenities</div>
                                    <div class="room-amenities mb-3">
                                        <div class="amenity-item">
                                            <i class="fas fa-wifi me-2"></i>
                                            <span>Wifi</span>
                                        </div>
                                        <div class="amenity-item">
                                            <i class="fas fa-tv me-2"></i>
                                            <span>Tv</span>
                                        </div>
                                        <div class="amenity-item">
                                            <i class="fas fa-snowflake me-2"></i>
                                            <span>Ac</span>
                                        </div>
                                    </div>
                                    <div class="room-description mb-3">
                                        <p class="text-muted">Comfortable standard room with modern amenities</p>
                                    </div>
                                    <div class="room-actions">
                                        <button class="room-edit-large" data-room="Standard Room" data-rate="₱2,599" data-capacity="2" data-type="Standard Room">
                                            <i class="fas fa-pen"></i> Edit
                                        </button>
                                        <button class="btn btn-link room-delete" title="Delete"><i class="fas fa-trash"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-xl-4 col-md-6 mb-4">
                        <div class="info-card">
                            <div class="card-header d-flex justify-content-between align-items-start">
                                <div>
                                    <h5>Standard Room</h5>
                                    <small class="text-muted">Room 103</small>
                                </div>
                                <span class="status-badge status-checkedin">Available</span>
                            </div>
                            <div class="card-body">
                                <div class="room-details">
                                    <div class="detail-row mb-2">
                                        <span class="field-label">Rate per night</span>
                                        <span class="detail-value">₱2,599</span>
                                    </div>
                                    <div class="detail-row mb-3">
                                        <span class="field-label">Capacity</span>
                                        <span class="detail-value"><i class="fas fa-users me-2"></i>2 guests</span>
                                    </div>
                                    <div class="field-label mb-1">Amenities</div>
                                    <div class="room-amenities mb-3">
                                        <div class="amenity-item">
                                            <i class="fas fa-wifi me-2"></i>
                                            <span>Wifi</span>
                                        </div>
                                        <div class="amenity-item">
                                            <i class="fas fa-tv me-2"></i>
                                            <span>Tv</span>
                                        </div>
                                        <div class="amenity-item">
                                            <i class="fas fa-snowflake me-2"></i>
                                            <span>Ac</span>
                                        </div>
                                    </div>
                                    <div class="room-description mb-3">
                                        <p class="text-muted">Comfortable standard room with modern amenities</p>
                                    </div>
                                    <div class="room-actions">
                                        <button class="room-edit-large" data-room="Standard Room" data-rate="₱2,599" data-capacity="2" data-type="Standard Room">
                                            <i class="fas fa-pen"></i> Edit
                                        </button>
                                        <button class="btn btn-link room-delete" title="Delete"><i class="fas fa-trash"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../script.js"></script>
    <script>
        // Neutralize any entrance animations applied by global scripts to avoid jumps
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.kpi-card, .info-card').forEach(function(card){
                card.style.transition = 'none';
                card.style.transform = 'none';
                card.style.opacity = '1';
            });
            // Wire Add Room Type button
            const addBtn = document.getElementById('addRoomTypeBtn');
            if (addBtn) {
                addBtn.addEventListener('click', function(){
                    // Prefill defaults and tick amenities
                    const typeName = document.getElementById('addTypeName');
                    const typeRate = document.getElementById('addTypeRate');
                    const typeCap = document.getElementById('addTypeCapacity');
                    const amenWifi = document.getElementById('addAmenWifi');
                    const amenTv = document.getElementById('addAmenTv');
                    const amenAc = document.getElementById('addAmenAc');
                    const typeDesc = document.getElementById('addTypeDesc');
                    if (typeName) typeName.value = '';
                    if (typeRate) typeRate.value = '';
                    if (typeCap) typeCap.value = typeCap.value || '2';
                    if (amenWifi) amenWifi.checked = true;
                    if (amenTv) amenTv.checked = true;
                    if (amenAc) amenAc.checked = true;
                    if (typeDesc) typeDesc.value = typeDesc.value || '';
                    const modal = new bootstrap.Modal(document.getElementById('addRoomTypeModal'));
                    modal.show();
                });
            }
            // Auto price by room type selection
            (function(){
                const rateByType = {
                    'Basic Studio Room': 922,
                    'Standard Room': 2599,
                    'Family Room': 3599,
                    'Premium Room': 3599
                };
                const typeSel = document.getElementById('addTypeName');
                const rateInput = document.getElementById('addTypeRate');
                if (typeSel && rateInput) {
                    typeSel.addEventListener('change', function(){
                        const val = this.value;
                        const rate = rateByType[val];
                        rateInput.value = rate != null ? String(rate) : '';
                    });
                }
            })();
        });
    </script>
    
    <!-- Add Room Type Modal -->
    <div class="modal fade" id="addRoomTypeModal" tabindex="-1" aria-labelledby="addRoomTypeLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addRoomTypeLabel">Add Room Type</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addRoomTypeForm">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">Room Type</label>
                                <select class="form-select" id="addTypeName">
                                    <option value="" selected disabled>Select room type</option>
                                    <option value="Basic Studio Room">Basic Studio Room</option>
                                    <option value="Standard Room">Standard Room</option>
                                    <option value="Family Room">Family Room</option>
                                    <option value="Premium Room">Premium Room</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Base Rate per night (₱)</label>
                                <input type="number" class="form-control" id="addTypeRate" min="0" step="1" placeholder="3500">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Default Capacity</label>
                                <input type="number" class="form-control" id="addTypeCapacity" min="1" step="1" placeholder="2">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Status</label>
                                <select class="form-select" id="addTypeStatus">
                                    <option value="Available" selected>Available</option>
                                    <option value="Occupied">Occupied</option>
                                    <option value="Maintenance">Maintenance</option>
                                </select>
                            </div>
                            <div class="col-12">
                                <label class="form-label">Amenities</label>
                                <div class="d-flex flex-wrap gap-3">
                                    <div class="form-check"><input class="form-check-input" type="checkbox" id="addAmenWifi"><label class="form-check-label" for="addAmenWifi">Wifi</label></div>
                                    <div class="form-check"><input class="form-check-input" type="checkbox" id="addAmenTv"><label class="form-check-label" for="addAmenTv">Tv</label></div>
                                    <div class="form-check"><input class="form-check-input" type="checkbox" id="addAmenAc"><label class="form-check-label" for="addAmenAc">Ac</label></div>
                                </div>
                            </div>
                            <div class="col-12">
                                <label class="form-label">Description</label>
                                <textarea class="form-control" id="addTypeDesc" rows="3" placeholder="Describe this room type"></textarea>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveAddRoomType">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Room Modal -->
    <div class="modal fade" id="editRoomModal" tabindex="-1" aria-labelledby="editRoomLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editRoomLabel">Edit Room</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editRoomForm">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">Room</label>
                                <input type="text" class="form-control" id="editRoomName">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Type</label>
                                <input type="text" class="form-control" id="editRoomType">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Rate per night</label>
                                <input type="text" class="form-control" id="editRoomRate">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Capacity</label>
                                <input type="number" class="form-control" id="editRoomCapacity" min="1">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Status</label>
                                <select class="form-select" id="editRoomStatus">
                                    <option value="Available">Available</option>
                                    <option value="Occupied">Occupied</option>
                                    <option value="Maintenance">Maintenance</option>
                                </select>
                            </div>
                            <div class="col-12">
                                <label class="form-label">Amenities</label>
                                <div class="d-flex flex-wrap gap-3">
                                    <div class="form-check"><input class="form-check-input" type="checkbox" id="amenWifi"><label class="form-check-label" for="amenWifi">Wifi</label></div>
                                    <div class="form-check"><input class="form-check-input" type="checkbox" id="amenTv"><label class="form-check-label" for="amenTv">Tv</label></div>
                                    <div class="form-check"><input class="form-check-input" type="checkbox" id="amenAc"><label class="form-check-label" for="amenAc">Ac</label></div>
                                </div>
                            </div>
                            <div class="col-12">
                                <label class="form-label">Description</label>
                                <textarea class="form-control" id="editRoomDesc" rows="3"></textarea>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveRoomChanges">Save Changes</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('.room-edit-large').forEach(btn => {
                btn.addEventListener('click', function () {
                    const room = this.getAttribute('data-room') || '';
                    const rate = this.getAttribute('data-rate') || '';
                    const cap = this.getAttribute('data-capacity') || '';
                    const type = this.getAttribute('data-type') || '';
                    const card = this.closest('.info-card');
                    // Track which card is being edited
                    window._editingRoomCard = card;
                    // Prefill fields
                    document.getElementById('editRoomName').value = room;
                    document.getElementById('editRoomRate').value = rate.replace(/[^\d]/g,'');
                    document.getElementById('editRoomCapacity').value = cap;
                    document.getElementById('editRoomType').value = type;
                    
                    // Get current status from the status badge
                    const statusBadge = card.querySelector('.status-badge');
                    const currentStatus = statusBadge ? statusBadge.textContent.trim() : 'Available';
                    document.getElementById('editRoomStatus').value = currentStatus;
                    // Prefill description from card if available
                    const descText = card?.querySelector('.room-description p')?.textContent || 'Comfortable room with modern amenities';
                    document.getElementById('editRoomDesc').value = descText;
                    // Ensure amenities are checked by default
                    const amenWifi = document.getElementById('amenWifi'); if (amenWifi) amenWifi.checked = true;
                    const amenTv = document.getElementById('amenTv'); if (amenTv) amenTv.checked = true;
                    const amenAc = document.getElementById('amenAc'); if (amenAc) amenAc.checked = true;
                    const modal = new bootstrap.Modal(document.getElementById('editRoomModal'));
                    modal.show();
                });
            });
            const saveBtn = document.getElementById('saveRoomChanges');
            if (saveBtn) {
                saveBtn.addEventListener('click', function () {
                    const modalEl = document.getElementById('editRoomModal');
                    const modal = bootstrap.Modal.getInstance(modalEl);
                    // Apply updates to the card being edited
                    const card = window._editingRoomCard;
                    if (card) {
                        const roomName = (document.getElementById('editRoomName')?.value || '').trim();
                        const roomType = (document.getElementById('editRoomType')?.value || '').trim();
                        const rateNum = Number((document.getElementById('editRoomRate')?.value || '0').replace(/[^\d]/g,'')) || 0;
                        const capVal = (document.getElementById('editRoomCapacity')?.value || '').trim();
                        const descVal = (document.getElementById('editRoomDesc')?.value || '').trim();
                        const statusVal = (document.getElementById('editRoomStatus')?.value || 'Available').trim();
                        const formatCurrency = (n) => `₱${Number(n).toLocaleString('en-PH')}`;
                        // Header: Update room type and keep room number
                        const headerDiv = card.querySelector('.card-header div');
                        if (headerDiv) {
                            const h5 = headerDiv.querySelector('h5');
                            const roomNumber = headerDiv.querySelector('small');
                            if (h5) h5.textContent = roomType;
                            // Keep existing room number
                        }
                        // Rate per night
                        const rateSpan = card.querySelector('.detail-row .detail-value');
                        if (rateSpan) rateSpan.textContent = formatCurrency(rateNum);
                        // Capacity
                        const capSpan = card.querySelector('.detail-row.mb-3 .detail-value');
                        if (capSpan) capSpan.innerHTML = `<i class="fas fa-users me-2"></i>${capVal || '1'} guests`;
                        // Description
                        const descP = card.querySelector('.room-description p');
                        if (descP) descP.textContent = descVal || 'Comfortable room with modern amenities';
                        
                        // Update status badge
                        const statusBadge = card.querySelector('.status-badge');
                        if (statusBadge) {
                            statusBadge.textContent = statusVal;
                            // Update status badge classes based on status
                            statusBadge.className = 'status-badge';
                            if (statusVal === 'Available') {
                                statusBadge.classList.add('status-checkedin');
                            } else if (statusVal === 'Occupied') {
                                statusBadge.classList.add('status-checkedout');
                            } else if (statusVal === 'Maintenance') {
                                statusBadge.classList.add('status-cancelled');
                            }
                        }
                        // Sync Edit button data attributes for next edit
                        const editBtn = card.querySelector('.room-edit-large');
                        if (editBtn) {
                            editBtn.setAttribute('data-room', roomName);
                            editBtn.setAttribute('data-rate', formatCurrency(rateNum));
                            editBtn.setAttribute('data-capacity', capVal || '1');
                            editBtn.setAttribute('data-type', roomType);
                        }
                        // Clear editing ref
                        window._editingRoomCard = null;
                        
                        // Update KPI counters after status change
                        updateKPICounters();
                    }
                    modal?.hide();
                });
            }
            const saveAddBtn = document.getElementById('saveAddRoomType');
            if (saveAddBtn) {
                saveAddBtn.addEventListener('click', function(){
                    const modalEl = document.getElementById('addRoomTypeModal');
                    const modal = bootstrap.Modal.getInstance(modalEl);
                    // Read form values
                    const typeName = (document.getElementById('addTypeName')?.value || '').trim();
                    const typeRate = (document.getElementById('addTypeRate')?.value || '').trim();
                    const typeCap = (document.getElementById('addTypeCapacity')?.value || '').trim();
                    const typeStatus = (document.getElementById('addTypeStatus')?.value || 'Available').trim();
                    const amenWifi = !!document.getElementById('addAmenWifi')?.checked;
                    const amenTv = !!document.getElementById('addAmenTv')?.checked;
                    const amenAc = !!document.getElementById('addAmenAc')?.checked;
                    const typeDesc = (document.getElementById('addTypeDesc')?.value || '').trim();
                    if (!typeName) { modal?.hide(); return; }
                    // Determine next room number by counting existing cards
                    // Find the room cards row by locating any existing info-card and climbing to its row
                    const anyCard = document.querySelector('.info-card');
                    const cardsSection = anyCard ? anyCard.closest('.row') : document.querySelector('.row');
                    const existingCards = Array.from(cardsSection?.querySelectorAll('.info-card') || []);
                    const nextNum = 100 + existingCards.length + 1;
                    const roomLabel = `Room ${nextNum}`; // auto-generated
                    const rateDisplay = typeRate ? `₱${Number(typeRate).toLocaleString('en-PH')}` : '₱0';
                    
                    // Determine status badge class based on selected status
                    let statusClass = 'status-checkedin'; // Default to Available
                    if (typeStatus === 'Occupied') {
                        statusClass = 'status-checkedout';
                    } else if (typeStatus === 'Maintenance') {
                        statusClass = 'status-cancelled';
                    }
                    // Build amenities HTML
                    const amenItems = [];
                    if (amenWifi) amenItems.push('<div class="amenity-item"><i class="fas fa-wifi me-2"></i><span>Wifi</span></div>');
                    if (amenTv) amenItems.push('<div class="amenity-item"><i class="fas fa-tv me-2"></i><span>Tv</span></div>');
                    if (amenAc) amenItems.push('<div class="amenity-item"><i class="fas fa-snowflake me-2"></i><span>Ac</span></div>');
                    const amenHtml = amenItems.join('\n                                        ');
                    // Create column and card
                    const col = document.createElement('div');
                    col.className = 'col-xl-4 col-md-6 mb-4';
                    col.innerHTML = `
                        <div class="info-card">
                            <div class="card-header d-flex justify-content-between align-items-start">
                                <div>
                                    <h5>${typeName}</h5>
                                    <small class="text-muted">${roomLabel}</small>
                                </div>
                                <span class="status-badge ${statusClass}">${typeStatus}</span>
                            </div>
                            <div class="card-body">
                                <div class="room-details">
                                    <div class="detail-row mb-2">
                                        <span class="field-label">Rate per night</span>
                                        <span class="detail-value">${rateDisplay}</span>
                                    </div>
                                    <div class="detail-row mb-3">
                                        <span class="field-label">Capacity</span>
                                        <span class="detail-value"><i class="fas fa-users me-2"></i>${typeCap || '1'} guests</span>
                                    </div>
                                    <div class="field-label mb-1">Amenities</div>
                                    <div class="room-amenities mb-3">
                                        ${amenHtml}
                                    </div>
                                    <div class="room-description mb-3">
                                        <p class="text-muted">${typeDesc || 'Comfortable room with modern amenities'}</p>
                                    </div>
                                    <div class="room-actions">
                                        <button class="room-edit-large" data-room="${typeName}" data-rate="${rateDisplay}" data-capacity="${typeCap || '1'}" data-type="${typeName}"><i class="fas fa-pen"></i> Edit</button>
                                        <button class="btn btn-link room-delete" title="Delete"><i class="fas fa-trash"></i></button>
                
                                    </div>
                                </div>
                            </div>
                        </div>`;
                    // Insert at the end (beside the last room)
                    const cols = Array.from(cardsSection.querySelectorAll(':scope > .col-xl-4.col-md-6.mb-4'));
                    cardsSection.appendChild(col);
                    
                    // Update KPI counters after adding new room
                    updateKPICounters();
                    // Re-bind edit button for the newly added card
                    const newEditBtn = col.querySelector('.room-edit-large');
                    if (newEditBtn) {
                        newEditBtn.addEventListener('click', function () {
                            const room = this.getAttribute('data-room') || '';
                            const rate = this.getAttribute('data-rate') || '';
                            const cap = this.getAttribute('data-capacity') || '';
                            const type = this.getAttribute('data-type') || '';
                            document.getElementById('editRoomName').value = room;
                            document.getElementById('editRoomRate').value = rate.replace(/[^\d]/g,'');
                            document.getElementById('editRoomCapacity').value = cap;
                            document.getElementById('editRoomType').value = type;
                            document.getElementById('editRoomDesc').value = '';
                            document.getElementById('editRoomStatus').value = 'Available';
                            const editModal = new bootstrap.Modal(document.getElementById('editRoomModal'));
                            editModal.show();
                        });
                    }
                    modal?.hide();
                });
            }
            
            // Function to update KPI counters based on current room statuses
            function updateKPICounters() {
                const allRooms = document.querySelectorAll('.info-card');
                let totalRooms = allRooms.length;
                let availableCount = 0;
                let occupiedCount = 0;
                let maintenanceCount = 0;
                
                allRooms.forEach(room => {
                    const statusBadge = room.querySelector('.status-badge');
                    if (statusBadge) {
                        const status = statusBadge.textContent.trim();
                        if (status === 'Available') {
                            availableCount++;
                        } else if (status === 'Occupied') {
                            occupiedCount++;
                        } else if (status === 'Maintenance') {
                            maintenanceCount++;
                        }
                    }
                });
                
                // Update KPI numbers
                const totalRoomsEl = document.querySelector('.kpi-card:nth-child(1) .kpi-number');
                const availableEl = document.querySelector('.kpi-card:nth-child(2) .kpi-number');
                const occupiedEl = document.querySelector('.kpi-card:nth-child(3) .kpi-number');
                const maintenanceEl = document.querySelector('.kpi-card:nth-child(4) .kpi-number');
                
                if (totalRoomsEl) totalRoomsEl.textContent = totalRooms;
                if (availableEl) availableEl.textContent = availableCount;
                if (occupiedEl) occupiedEl.textContent = occupiedCount;
                if (maintenanceEl) maintenanceEl.textContent = maintenanceCount;
            }
            
            // Initialize KPI counters on page load
            updateKPICounters();
        });
    </script>
</body>
</html>
